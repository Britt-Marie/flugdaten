<!DOCTYPE html>
<html>

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<!-- Include CSS -->
<link rel="stylesheet" href="https://libs.cartocdn.com/airship-style/v2.1.0/airship.css">
<!-- Include Icons -->
<link rel="stylesheet" href="https://libs.cartocdn.com/airship-icons/v2.1.0/icons.css">
<!-- Include Web Components -->
<script src="https://libs.cartocdn.com/airship-components/v2.1.0/airship.js"></script>

<!-- Include CARTO VL JS -->
<script src="https://libs.cartocdn.com/carto-vl/v1.3.1/carto-vl.min.js"></script>
<link href="https://api.tiles.mapbox.com/mapbox-gl-js/v0.52.0/mapbox-gl.css" rel="stylesheet" />
<script src="https://api.tiles.mapbox.com/mapbox-gl-js/v0.52.0/mapbox-gl.js"></script>
</head>

<body class="as-app-body">

<div class="as-app">
<div class="as-content">
<main class="as-main">
<div class="as-map-area">
<div id="map"></div>
</div>
</main>
<aside class="as-sidebar as-sidebar--right">
<as-category-widget
id="flughaefen-widget"
heading="Inlandsflüge"
description="Die beliebtesten Inlandsflüge ab Startflughafen">
</as-category-widget>
</aside>
</div>
</div>

<script>
const map = new mapboxgl.Map({
container: 'map',
style: carto.basemaps.positron,
center: [10, 51.1],
zoom: 5.5,
scrollZoom: false,
dragRotate: false,
touchZoomRotate: false
});
const nav = new mapboxgl.NavigationControl({
showCompass: false
});
map.addControl(nav, 'top-left');
// Define user
/* carto.setDefaultAuth({
user: 'bbbrille',
apiKey: 'dcf94a265160c14f37be286d14679f3e6026e232'
}); */
// Define layer 1
const punkte = {"type": "FeatureCollection", "features": [{"type":"Feature","geometry":{"type":"Point","coordinates":[13.521615,52.385441]},"properties":{"cartodb_id":1,"flughafen":"Berlin/Schönefeld","kurzel":"SXF","breitengrad":52.385441,"langengrad":13.521615}},{"type":"Feature","geometry":{"type":"Point","coordinates":[13.288437,52.558833]},"properties":{"cartodb_id":2,"flughafen":"BerlinTegel","kurzel":"TXL","breitengrad":52.558833,"langengrad":13.288437}},{"type":"Feature","geometry":{"type":"Point","coordinates":[9.997413,53.633622]},"properties":{"cartodb_id":3,"flughafen":"Hamburg","kurzel":"HAM","breitengrad":53.633622,"langengrad":9.997413}},{"type":"Feature","geometry":{"type":"Point","coordinates":[7.140734,50.870717]},"properties":{"cartodb_id":4,"flughafen":"Köln/Bonn","kurzel":"CGN","breitengrad":50.870717,"langengrad":7.140734}},{"type":"Feature","geometry":{"type":"Point","coordinates":[12.220381,51.422081]},"properties":{"cartodb_id":5,"flughafen":"Leipzig","kurzel":"LEJ","breitengrad":51.422081,"langengrad":12.220381}},{"type":"Feature","geometry":{"type":"Point","coordinates":[11.079808,49.49712]},"properties":{"cartodb_id":6,"flughafen":"Nürnberg","kurzel":"NUE","breitengrad":49.49712,"langengrad":11.079808}},{"type":"Feature","geometry":{"type":"Point","coordinates":[9.205576,48.687637]},"properties":{"cartodb_id":7,"flughafen":"Stuttgart","kurzel":"STR","breitengrad":48.687637,"langengrad":9.205576}},{"type":"Feature","geometry":{"type":"Point","coordinates":[9.688992,52.461849]},"properties":{"cartodb_id":8,"flughafen":"Hannover","kurzel":"HAJ","breitengrad":52.461849,"langengrad":9.688992}},{"type":"Feature","geometry":{"type":"Point","coordinates":[6.766791,51.287615]},"properties":{"cartodb_id":9,"flughafen":"Düsseldorf","kurzel":"DUS","breitengrad":51.287615,"langengrad":6.766791}},{"type":"Feature","geometry":{"type":"Point","coordinates":[8.580055,50.041381]},"properties":{"cartodb_id":10,"flughafen":"Frankfurt","kurzel":"FRA","breitengrad":50.041381,"langengrad":8.580055}},{"type":"Feature","geometry":{"type":"Point","coordinates":[11.775028,48.353662]},"properties":{"cartodb_id":11,"flughafen":"München","kurzel":"MUC","breitengrad":48.353662,"langengrad":11.775028}}]}

const koordinaten_source = new carto.source.GeoJSON(punkte);
const viz = new carto.Viz(`
@flughaefen: viewportFeatures($flughafen)
`);
const layer1 = new carto.Layer('koordinaten', koordinaten_source, viz);

const $categoryWidget = document.querySelector('#flughaefen-widget');
layer1.on('updated', updateWidgets);
layer1.addTo(map, ); // was ist das?
//layer.on('loaded', hideLoader);
function hideLoader() {
document.getElementById('loader').style.opacity = '0';
}

function updateWidgets() {
$categoryWidget.categories = viz.variables.flughaefen.value
.map(feature => ({
name: feature.properties.flughafen,
value: feature.properties.pop_max
}))
.sort((a, b) => b.value - a.value);
};

// Define layer 2
// [10.01953125, 53.61857936489517],
        //  [11.557617187499998, 48.28319289548349]

const geojson = {"type": "FeatureCollection", "features": [{"type":"Feature","geometry":{"type":"LineString","coordinates":[[13.521615,52.385441],[7.140734,50.870717]]},"properties":{"cartodb_id":1,"flughafen":"Berlin/Schönefeld","kurzel":"SXF","flughafen1":"Köln/Bonn","flughafen2":"Berlin/Schönefeld","anzahl_fluge_2018":2695,"co2_verbrauch_mit_auslastung":"100","kurzel_f1":"CGN","kurzel_f2":"SXF","anzahl_passagiere_2018":320577,"auslastung_passagiere_2018":"84,2"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[13.288437,52.558833],[6.766791,51.287615]]},"properties":{"cartodb_id":2,"flughafen":"BerlinTegel","kurzel":"TXL","flughafen1":"Düsseldorf","flughafen2":"Berlin/Tegel","anzahl_fluge_2018":11095,"co2_verbrauch_mit_auslastung":"121,2","kurzel_f1":"DUS","kurzel_f2":"TXL","anzahl_passagiere_2018":1198377,"auslastung_passagiere_2018":"69,2"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[13.288437,52.558833],[8.580055,50.041381]]},"properties":{"cartodb_id":2,"flughafen":"BerlinTegel","kurzel":"TXL","flughafen1":"Frankfurt","flughafen2":"Berlin/Tegel","anzahl_fluge_2018":16886,"co2_verbrauch_mit_auslastung":"102,9","kurzel_f1":"FRA","kurzel_f2":"TXL","anzahl_passagiere_2018":2291823,"auslastung_passagiere_2018":"75,2"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[13.288437,52.558833],[7.140734,50.870717]]},"properties":{"cartodb_id":2,"flughafen":"BerlinTegel","kurzel":"TXL","flughafen1":"Köln/Bonn","flughafen2":"Berlin/Tegel","anzahl_fluge_2018":10650,"co2_verbrauch_mit_auslastung":"117,6","kurzel_f1":"CGN","kurzel_f2":"TXL","anzahl_passagiere_2018":1174845,"auslastung_passagiere_2018":"70,5"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[13.288437,52.558833],[11.775028,48.353662]]},"properties":{"cartodb_id":2,"flughafen":"BerlinTegel","kurzel":"TXL","flughafen1":"München","flughafen2":"Berlin/Tegel","anzahl_fluge_2018":15942,"co2_verbrauch_mit_auslastung":"117,8","kurzel_f1":"MUC","kurzel_f2":"TXL","anzahl_passagiere_2018":1988444,"auslastung_passagiere_2018":"72,4"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[13.288437,52.558833],[11.079808,49.49712]]},"properties":{"cartodb_id":2,"flughafen":"BerlinTegel","kurzel":"TXL","flughafen1":"Nürnberg","flughafen2":"Berlin/Tegel","anzahl_fluge_2018":1937,"co2_verbrauch_mit_auslastung":"201","kurzel_f1":"NUE","kurzel_f2":"TXL","anzahl_passagiere_2018":87832,"auslastung_passagiere_2018":"47,9"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[13.288437,52.558833],[9.205576,48.687637]]},"properties":{"cartodb_id":2,"flughafen":"BerlinTegel","kurzel":"TXL","flughafen1":"Stuttgart","flughafen2":"Berlin/Tegel","anzahl_fluge_2018":11651,"co2_verbrauch_mit_auslastung":"111,8","kurzel_f1":"STR","kurzel_f2":"TXL","anzahl_passagiere_2018":1243154,"auslastung_passagiere_2018":"73,7"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[6.766791,51.287615],[13.288437,52.558833]]},"properties":{"cartodb_id":9,"flughafen":"Düsseldorf","kurzel":"DUS","flughafen1":"Berlin/Tegel","flughafen2":"Düsseldorf","anzahl_fluge_2018":11095,"co2_verbrauch_mit_auslastung":"121,2","kurzel_f1":"TXL","kurzel_f2":"DUS","anzahl_passagiere_2018":1198377,"auslastung_passagiere_2018":"69,2"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[6.766791,51.287615],[8.580055,50.041381]]},"properties":{"cartodb_id":9,"flughafen":"Düsseldorf","kurzel":"DUS","flughafen1":"Frankfurt","flughafen2":"Düsseldorf","anzahl_fluge_2018":4934,"co2_verbrauch_mit_auslastung":"103,8","kurzel_f1":"FRA","kurzel_f2":"DUS","anzahl_passagiere_2018":430879,"auslastung_passagiere_2018":"65,3"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[6.766791,51.287615],[9.997413,53.633622]]},"properties":{"cartodb_id":9,"flughafen":"Düsseldorf","kurzel":"DUS","flughafen1":"Hamburg","flughafen2":"Düsseldorf","anzahl_fluge_2018":5413,"co2_verbrauch_mit_auslastung":"135,7","kurzel_f1":"HAM","kurzel_f2":"DUS","anzahl_passagiere_2018":525779,"auslastung_passagiere_2018":"65,6"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[6.766791,51.287615],[12.220381,51.422081]]},"properties":{"cartodb_id":9,"flughafen":"Düsseldorf","kurzel":"DUS","flughafen1":"Leipzig","flughafen2":"Düsseldorf","anzahl_fluge_2018":1965,"co2_verbrauch_mit_auslastung":"151,5","kurzel_f1":"LEJ","kurzel_f2":"DUS","anzahl_passagiere_2018":104748,"auslastung_passagiere_2018":"64,3"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[6.766791,51.287615],[11.775028,48.353662]]},"properties":{"cartodb_id":9,"flughafen":"Düsseldorf","kurzel":"DUS","flughafen1":"München","flughafen2":"Düsseldorf","anzahl_fluge_2018":12717,"co2_verbrauch_mit_auslastung":"118,2","kurzel_f1":"MUC","kurzel_f2":"DUS","anzahl_passagiere_2018":1422715,"auslastung_passagiere_2018":"73"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[6.766791,51.287615],[11.079808,49.49712]]},"properties":{"cartodb_id":9,"flughafen":"Düsseldorf","kurzel":"DUS","flughafen1":"Nürnberg","flughafen2":"Düsseldorf","anzahl_fluge_2018":2528,"co2_verbrauch_mit_auslastung":"136,1","kurzel_f1":"NUE","kurzel_f2":"DUS","anzahl_passagiere_2018":154423,"auslastung_passagiere_2018":"69,2"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[6.766791,51.287615],[9.205576,48.687637]]},"properties":{"cartodb_id":9,"flughafen":"Düsseldorf","kurzel":"DUS","flughafen1":"Stuttgart","flughafen2":"Düsseldorf","anzahl_fluge_2018":2704,"co2_verbrauch_mit_auslastung":"129,2","kurzel_f1":"STR","kurzel_f2":"DUS","anzahl_passagiere_2018":147387,"auslastung_passagiere_2018":"67,8"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[8.580055,50.041381],[13.288437,52.558833]]},"properties":{"cartodb_id":10,"flughafen":"Frankfurt","kurzel":"FRA","flughafen1":"Berlin/Tegel","flughafen2":"Frankfurt","anzahl_fluge_2018":16886,"co2_verbrauch_mit_auslastung":"102,9","kurzel_f1":"TXL","kurzel_f2":"FRA","anzahl_passagiere_2018":2291823,"auslastung_passagiere_2018":"75,2"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[8.580055,50.041381],[6.766791,51.287615]]},"properties":{"cartodb_id":10,"flughafen":"Frankfurt","kurzel":"FRA","flughafen1":"Düsseldorf","flughafen2":"Frankfurt","anzahl_fluge_2018":4934,"co2_verbrauch_mit_auslastung":"103,8","kurzel_f1":"DUS","kurzel_f2":"FRA","anzahl_passagiere_2018":430879,"auslastung_passagiere_2018":"65,3"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[8.580055,50.041381],[9.997413,53.633622]]},"properties":{"cartodb_id":10,"flughafen":"Frankfurt","kurzel":"FRA","flughafen1":"Hamburg","flughafen2":"Frankfurt","anzahl_fluge_2018":10815,"co2_verbrauch_mit_auslastung":"100,7","kurzel_f1":"HAM","kurzel_f2":"FRA","anzahl_passagiere_2018":1440241,"auslastung_passagiere_2018":"73,7"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[8.580055,50.041381],[9.688992,52.461849]]},"properties":{"cartodb_id":10,"flughafen":"Frankfurt","kurzel":"FRA","flughafen1":"Hannover","flughafen2":"Frankfurt","anzahl_fluge_2018":4046,"co2_verbrauch_mit_auslastung":"104,3","kurzel_f1":"HAJ","kurzel_f2":"FRA","anzahl_passagiere_2018":383070,"auslastung_passagiere_2018":"71,6"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[8.580055,50.041381],[12.220381,51.422081]]},"properties":{"cartodb_id":10,"flughafen":"Frankfurt","kurzel":"FRA","flughafen1":"Leipzig","flughafen2":"Frankfurt","anzahl_fluge_2018":4970,"co2_verbrauch_mit_auslastung":"111,9","kurzel_f1":"LEJ","kurzel_f2":"FRA","anzahl_passagiere_2018":289525,"auslastung_passagiere_2018":"70,8"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[8.580055,50.041381],[11.775028,48.353662]]},"properties":{"cartodb_id":10,"flughafen":"Frankfurt","kurzel":"FRA","flughafen1":"München","flughafen2":"Frankfurt","anzahl_fluge_2018":10026,"co2_verbrauch_mit_auslastung":"112","kurzel_f1":"MUC","kurzel_f2":"FRA","anzahl_passagiere_2018":1198991,"auslastung_passagiere_2018":"71"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[8.580055,50.041381],[11.079808,49.49712]]},"properties":{"cartodb_id":10,"flughafen":"Frankfurt","kurzel":"FRA","flughafen1":"Nürnberg","flughafen2":"Frankfurt","anzahl_fluge_2018":3371,"co2_verbrauch_mit_auslastung":"100,3","kurzel_f1":"NUE","kurzel_f2":"FRA","anzahl_passagiere_2018":266479,"auslastung_passagiere_2018":"68,4"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[8.580055,50.041381],[9.205576,48.687637]]},"properties":{"cartodb_id":10,"flughafen":"Frankfurt","kurzel":"FRA","flughafen1":"Stuttgart","flughafen2":"Frankfurt","anzahl_fluge_2018":3662,"co2_verbrauch_mit_auslastung":"85,6","kurzel_f1":"STR","kurzel_f2":"FRA","anzahl_passagiere_2018":325814,"auslastung_passagiere_2018":"69,5"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.997413,53.633622],[6.766791,51.287615]]},"properties":{"cartodb_id":3,"flughafen":"Hamburg","kurzel":"HAM","flughafen1":"Düsseldorf","flughafen2":"Hamburg","anzahl_fluge_2018":5413,"co2_verbrauch_mit_auslastung":"135,7","kurzel_f1":"DUS","kurzel_f2":"HAM","anzahl_passagiere_2018":525779,"auslastung_passagiere_2018":"65,6"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.997413,53.633622],[8.580055,50.041381]]},"properties":{"cartodb_id":3,"flughafen":"Hamburg","kurzel":"HAM","flughafen1":"Frankfurt","flughafen2":"Hamburg","anzahl_fluge_2018":10815,"co2_verbrauch_mit_auslastung":"100,7","kurzel_f1":"FRA","kurzel_f2":"HAM","anzahl_passagiere_2018":1440241,"auslastung_passagiere_2018":"73,7"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.997413,53.633622],[7.140734,50.870717]]},"properties":{"cartodb_id":3,"flughafen":"Hamburg","kurzel":"HAM","flughafen1":"Köln/Bonn","flughafen2":"Hamburg","anzahl_fluge_2018":5056,"co2_verbrauch_mit_auslastung":"146","kurzel_f1":"CGN","kurzel_f2":"HAM","anzahl_passagiere_2018":477951,"auslastung_passagiere_2018":"64,4"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.997413,53.633622],[11.775028,48.353662]]},"properties":{"cartodb_id":3,"flughafen":"Hamburg","kurzel":"HAM","flughafen1":"München","flughafen2":"Hamburg","anzahl_fluge_2018":13198,"co2_verbrauch_mit_auslastung":"119,8","kurzel_f1":"MUC","kurzel_f2":"HAM","anzahl_passagiere_2018":1749304,"auslastung_passagiere_2018":"78,7"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.997413,53.633622],[11.079808,49.49712]]},"properties":{"cartodb_id":3,"flughafen":"Hamburg","kurzel":"HAM","flughafen1":"Nürnberg","flughafen2":"Hamburg","anzahl_fluge_2018":1781,"co2_verbrauch_mit_auslastung":"131,2","kurzel_f1":"NUE","kurzel_f2":"HAM","anzahl_passagiere_2018":175779,"auslastung_passagiere_2018":"63,4"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.997413,53.633622],[9.205576,48.687637]]},"properties":{"cartodb_id":3,"flughafen":"Hamburg","kurzel":"HAM","flughafen1":"Stuttgart","flughafen2":"Hamburg","anzahl_fluge_2018":6572,"co2_verbrauch_mit_auslastung":"114,9","kurzel_f1":"STR","kurzel_f2":"HAM","anzahl_passagiere_2018":738694,"auslastung_passagiere_2018":"76"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.688992,52.461849],[8.580055,50.041381]]},"properties":{"cartodb_id":8,"flughafen":"Hannover","kurzel":"HAJ","flughafen1":"Frankfurt","flughafen2":"Hannover","anzahl_fluge_2018":4046,"co2_verbrauch_mit_auslastung":"104,3","kurzel_f1":"FRA","kurzel_f2":"HAJ","anzahl_passagiere_2018":383070,"auslastung_passagiere_2018":"71,6"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.688992,52.461849],[11.775028,48.353662]]},"properties":{"cartodb_id":8,"flughafen":"Hannover","kurzel":"HAJ","flughafen1":"München","flughafen2":"Hannover","anzahl_fluge_2018":5390,"co2_verbrauch_mit_auslastung":"124,6","kurzel_f1":"MUC","kurzel_f2":"HAJ","anzahl_passagiere_2018":528059,"auslastung_passagiere_2018":"68,6"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.688992,52.461849],[9.205576,48.687637]]},"properties":{"cartodb_id":8,"flughafen":"Hannover","kurzel":"HAJ","flughafen1":"Stuttgart","flughafen2":"Hannover","anzahl_fluge_2018":2555,"co2_verbrauch_mit_auslastung":"124,8","kurzel_f1":"STR","kurzel_f2":"HAJ","anzahl_passagiere_2018":177320,"auslastung_passagiere_2018":"60,9"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[7.140734,50.870717],[13.521615,52.385441]]},"properties":{"cartodb_id":4,"flughafen":"Köln/Bonn","kurzel":"CGN","flughafen1":"Berlin/Schönefeld","flughafen2":"Köln/Bonn","anzahl_fluge_2018":2695,"co2_verbrauch_mit_auslastung":"100","kurzel_f1":"SXF","kurzel_f2":"CGN","anzahl_passagiere_2018":320577,"auslastung_passagiere_2018":"84,2"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[7.140734,50.870717],[13.288437,52.558833]]},"properties":{"cartodb_id":4,"flughafen":"Köln/Bonn","kurzel":"CGN","flughafen1":"Berlin/Tegel","flughafen2":"Köln/Bonn","anzahl_fluge_2018":10650,"co2_verbrauch_mit_auslastung":"117,7","kurzel_f1":"TXL","kurzel_f2":"CGN","anzahl_passagiere_2018":1174845,"auslastung_passagiere_2018":"70,5"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[7.140734,50.870717],[9.997413,53.633622]]},"properties":{"cartodb_id":4,"flughafen":"Köln/Bonn","kurzel":"CGN","flughafen1":"Hamburg","flughafen2":"Köln/Bonn","anzahl_fluge_2018":5056,"co2_verbrauch_mit_auslastung":"146","kurzel_f1":"HAM","kurzel_f2":"CGN","anzahl_passagiere_2018":477951,"auslastung_passagiere_2018":"64,4"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[7.140734,50.870717],[12.220381,51.422081]]},"properties":{"cartodb_id":4,"flughafen":"Köln/Bonn","kurzel":"CGN","flughafen1":"Leipzig","flughafen2":"Köln/Bonn","anzahl_fluge_2018":2733,"co2_verbrauch_mit_auslastung":"184,8","kurzel_f1":"LEJ","kurzel_f2":"CGN","anzahl_passagiere_2018":89840,"auslastung_passagiere_2018":"50,5"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[7.140734,50.870717],[11.775028,48.353662]]},"properties":{"cartodb_id":4,"flughafen":"Köln/Bonn","kurzel":"CGN","flughafen1":"München","flughafen2":"Köln/Bonn","anzahl_fluge_2018":10386,"co2_verbrauch_mit_auslastung":"112,3","kurzel_f1":"MUC","kurzel_f2":"CGN","anzahl_passagiere_2018":1017981,"auslastung_passagiere_2018":"70,1"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[12.220381,51.422081],[6.766791,51.287615]]},"properties":{"cartodb_id":5,"flughafen":"Leipzig","kurzel":"LEJ","flughafen1":"Düsseldorf","flughafen2":"Leipzig","anzahl_fluge_2018":1965,"co2_verbrauch_mit_auslastung":"151,5","kurzel_f1":"DUS","kurzel_f2":"LEJ","anzahl_passagiere_2018":104748,"auslastung_passagiere_2018":"64,3"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[12.220381,51.422081],[8.580055,50.041381]]},"properties":{"cartodb_id":5,"flughafen":"Leipzig","kurzel":"LEJ","flughafen1":"Frankfurt","flughafen2":"Leipzig","anzahl_fluge_2018":4970,"co2_verbrauch_mit_auslastung":"111,9","kurzel_f1":"FRA","kurzel_f2":"LEJ","anzahl_passagiere_2018":289525,"auslastung_passagiere_2018":"70,8"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[12.220381,51.422081],[7.140734,50.870717]]},"properties":{"cartodb_id":5,"flughafen":"Leipzig","kurzel":"LEJ","flughafen1":"Köln/Bonn","flughafen2":"Leipzig","anzahl_fluge_2018":2733,"co2_verbrauch_mit_auslastung":"184,8","kurzel_f1":"CGN","kurzel_f2":"LEJ","anzahl_passagiere_2018":89840,"auslastung_passagiere_2018":"50,5"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[12.220381,51.422081],[11.775028,48.353662]]},"properties":{"cartodb_id":5,"flughafen":"Leipzig","kurzel":"LEJ","flughafen1":"München","flughafen2":"Leipzig","anzahl_fluge_2018":3050,"co2_verbrauch_mit_auslastung":"123,5","kurzel_f1":"MUC","kurzel_f2":"LEJ","anzahl_passagiere_2018":155915,"auslastung_passagiere_2018":"72,2"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[12.220381,51.422081],[9.205576,48.687637]]},"properties":{"cartodb_id":5,"flughafen":"Leipzig","kurzel":"LEJ","flughafen1":"Stuttgart","flughafen2":"Leipzig","anzahl_fluge_2018":1858,"co2_verbrauch_mit_auslastung":"181,8","kurzel_f1":"STR","kurzel_f2":"LEJ","anzahl_passagiere_2018":67912,"auslastung_passagiere_2018":"52,7"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.775028,48.353662],[13.288437,52.558833]]},"properties":{"cartodb_id":11,"flughafen":"München","kurzel":"MUC","flughafen1":"Berlin/Tegel","flughafen2":"München","anzahl_fluge_2018":15942,"co2_verbrauch_mit_auslastung":"117,8","kurzel_f1":"TXL","kurzel_f2":"MUC","anzahl_passagiere_2018":1988444,"auslastung_passagiere_2018":"72,4"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.775028,48.353662],[6.766791,51.287615]]},"properties":{"cartodb_id":11,"flughafen":"München","kurzel":"MUC","flughafen1":"Düsseldorf","flughafen2":"München","anzahl_fluge_2018":12717,"co2_verbrauch_mit_auslastung":"118,2","kurzel_f1":"DUS","kurzel_f2":"MUC","anzahl_passagiere_2018":1422715,"auslastung_passagiere_2018":"73"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.775028,48.353662],[8.580055,50.041381]]},"properties":{"cartodb_id":11,"flughafen":"München","kurzel":"MUC","flughafen1":"Frankfurt","flughafen2":"München","anzahl_fluge_2018":10026,"co2_verbrauch_mit_auslastung":"112","kurzel_f1":"FRA","kurzel_f2":"MUC","anzahl_passagiere_2018":1198991,"auslastung_passagiere_2018":"71"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.775028,48.353662],[9.997413,53.633622]]},"properties":{"cartodb_id":11,"flughafen":"München","kurzel":"MUC","flughafen1":"Hamburg","flughafen2":"München","anzahl_fluge_2018":13198,"co2_verbrauch_mit_auslastung":"119,8","kurzel_f1":"HAM","kurzel_f2":"MUC","anzahl_passagiere_2018":1749304,"auslastung_passagiere_2018":"78,7"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.775028,48.353662],[9.688992,52.461849]]},"properties":{"cartodb_id":11,"flughafen":"München","kurzel":"MUC","flughafen1":"Hannover","flughafen2":"München","anzahl_fluge_2018":5390,"co2_verbrauch_mit_auslastung":"124,6","kurzel_f1":"HAJ","kurzel_f2":"MUC","anzahl_passagiere_2018":528059,"auslastung_passagiere_2018":"68,6"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.775028,48.353662],[7.140734,50.870717]]},"properties":{"cartodb_id":11,"flughafen":"München","kurzel":"MUC","flughafen1":"Köln/Bonn","flughafen2":"München","anzahl_fluge_2018":10386,"co2_verbrauch_mit_auslastung":"112,3","kurzel_f1":"CGN","kurzel_f2":"MUC","anzahl_passagiere_2018":1017981,"auslastung_passagiere_2018":"70,1"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.775028,48.353662],[12.220381,51.422081]]},"properties":{"cartodb_id":11,"flughafen":"München","kurzel":"MUC","flughafen1":"Leipzig","flughafen2":"München","anzahl_fluge_2018":3050,"co2_verbrauch_mit_auslastung":"123,5","kurzel_f1":"LEJ","kurzel_f2":"MUC","anzahl_passagiere_2018":155915,"auslastung_passagiere_2018":"72,2"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.775028,48.353662],[11.079808,49.49712]]},"properties":{"cartodb_id":11,"flughafen":"München","kurzel":"MUC","flughafen1":"Nürnberg","flughafen2":"München","anzahl_fluge_2018":2503,"co2_verbrauch_mit_auslastung":"131,7","kurzel_f1":"NUE","kurzel_f2":"MUC","anzahl_passagiere_2018":131887,"auslastung_passagiere_2018":"64,6"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.775028,48.353662],[9.205576,48.687637]]},"properties":{"cartodb_id":11,"flughafen":"München","kurzel":"MUC","flughafen1":"Stuttgart","flughafen2":"München","anzahl_fluge_2018":3292,"co2_verbrauch_mit_auslastung":"89,5","kurzel_f1":"STR","kurzel_f2":"MUC","anzahl_passagiere_2018":213113,"auslastung_passagiere_2018":"78"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.079808,49.49712],[13.288437,52.558833]]},"properties":{"cartodb_id":6,"flughafen":"Nürnberg","kurzel":"NUE","flughafen1":"Berlin/Tegel","flughafen2":"Nürnberg","anzahl_fluge_2018":1937,"co2_verbrauch_mit_auslastung":"201,3","kurzel_f1":"TXL","kurzel_f2":"NUE","anzahl_passagiere_2018":87832,"auslastung_passagiere_2018":"47,9"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.079808,49.49712],[6.766791,51.287615]]},"properties":{"cartodb_id":6,"flughafen":"Nürnberg","kurzel":"NUE","flughafen1":"Düsseldorf","flughafen2":"Nürnberg","anzahl_fluge_2018":2528,"co2_verbrauch_mit_auslastung":"136,1","kurzel_f1":"DUS","kurzel_f2":"NUE","anzahl_passagiere_2018":154423,"auslastung_passagiere_2018":"69,2"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.079808,49.49712],[8.580055,50.041381]]},"properties":{"cartodb_id":6,"flughafen":"Nürnberg","kurzel":"NUE","flughafen1":"Frankfurt","flughafen2":"Nürnberg","anzahl_fluge_2018":3371,"co2_verbrauch_mit_auslastung":"100,3","kurzel_f1":"FRA","kurzel_f2":"NUE","anzahl_passagiere_2018":266479,"auslastung_passagiere_2018":"68,4"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.079808,49.49712],[9.997413,53.633622]]},"properties":{"cartodb_id":6,"flughafen":"Nürnberg","kurzel":"NUE","flughafen1":"Hamburg","flughafen2":"Nürnberg","anzahl_fluge_2018":1781,"co2_verbrauch_mit_auslastung":"131,4","kurzel_f1":"HAM","kurzel_f2":"NUE","anzahl_passagiere_2018":175779,"auslastung_passagiere_2018":"63,4"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[11.079808,49.49712],[11.775028,48.353662]]},"properties":{"cartodb_id":6,"flughafen":"Nürnberg","kurzel":"NUE","flughafen1":"München","flughafen2":"Nürnberg","anzahl_fluge_2018":2503,"co2_verbrauch_mit_auslastung":"131,7","kurzel_f1":"MUC","kurzel_f2":"NUE","anzahl_passagiere_2018":131887,"auslastung_passagiere_2018":"64,6"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.205576,48.687637],[13.288437,52.558833]]},"properties":{"cartodb_id":7,"flughafen":"Stuttgart","kurzel":"STR","flughafen1":"Berlin/Tegel","flughafen2":"Stuttgart","anzahl_fluge_2018":11651,"co2_verbrauch_mit_auslastung":"111,9","kurzel_f1":"TXL","kurzel_f2":"STR","anzahl_passagiere_2018":1243154,"auslastung_passagiere_2018":"73,7"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.205576,48.687637],[6.766791,51.287615]]},"properties":{"cartodb_id":7,"flughafen":"Stuttgart","kurzel":"STR","flughafen1":"Düsseldorf","flughafen2":"Stuttgart","anzahl_fluge_2018":2704,"co2_verbrauch_mit_auslastung":"129,2","kurzel_f1":"DUS","kurzel_f2":"STR","anzahl_passagiere_2018":147387,"auslastung_passagiere_2018":"67,8"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.205576,48.687637],[8.580055,50.041381]]},"properties":{"cartodb_id":7,"flughafen":"Stuttgart","kurzel":"STR","flughafen1":"Frankfurt","flughafen2":"Stuttgart","anzahl_fluge_2018":3662,"co2_verbrauch_mit_auslastung":"85,6","kurzel_f1":"FRA","kurzel_f2":"STR","anzahl_passagiere_2018":325814,"auslastung_passagiere_2018":"69,5"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.205576,48.687637],[9.997413,53.633622]]},"properties":{"cartodb_id":7,"flughafen":"Stuttgart","kurzel":"STR","flughafen1":"Hamburg","flughafen2":"Stuttgart","anzahl_fluge_2018":6572,"co2_verbrauch_mit_auslastung":"114,9","kurzel_f1":"HAM","kurzel_f2":"STR","anzahl_passagiere_2018":738694,"auslastung_passagiere_2018":"76"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.205576,48.687637],[9.688992,52.461849]]},"properties":{"cartodb_id":7,"flughafen":"Stuttgart","kurzel":"STR","flughafen1":"Hannover","flughafen2":"Stuttgart","anzahl_fluge_2018":2555,"co2_verbrauch_mit_auslastung":"124,8","kurzel_f1":"HAJ","kurzel_f2":"STR","anzahl_passagiere_2018":177320,"auslastung_passagiere_2018":"60,9"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.205576,48.687637],[12.220381,51.422081]]},"properties":{"cartodb_id":7,"flughafen":"Stuttgart","kurzel":"STR","flughafen1":"Leipzig","flughafen2":"Stuttgart","anzahl_fluge_2018":1858,"co2_verbrauch_mit_auslastung":"181,8","kurzel_f1":"LEJ","kurzel_f2":"STR","anzahl_passagiere_2018":67912,"auslastung_passagiere_2018":"52,7"}},{"type":"Feature","geometry":{"type":"LineString","coordinates":[[9.205576,48.687637],[11.775028,48.353662]]},"properties":{"cartodb_id":7,"flughafen":"Stuttgart","kurzel":"STR","flughafen1":"München","flughafen2":"Suttgart","anzahl_fluge_2018":3292,"co2_verbrauch_mit_auslastung":"89,5","kurzel_f1":"MUC","kurzel_f2":"STR","anzahl_passagiere_2018":213113,"auslastung_passagiere_2018":"78"}}]
};


const fluglinien_source = new carto.source.GeoJSON(geojson);
const viz2 = new carto.Viz('width: 5, color: ramp($auslastung_passagiere_2018, [#400611, #FF1744])');
const layer2 = new carto.Layer('fluglinien', fluglinien_source, viz2);

layer2.addTo(map); /* The ID of an existing layer to insert the new layer before. If this values is not passed the layer will be added on the top of the existing layers. */
layer2.on('loaded', hideLoader);

 function hideLoader() {
            document.getElementById('loader').style.opacity = '0';
        }


/* const fluglinienSource = new carto.source.SQL(query, {
user: 'bbbrille',
apiKey: 'dcf94a265160c14f37be286d14679f3e6026e232'
});

const query = 'SELECT

k2.cartodb_id, k2.flughafen, k2.kurzel, f.flughafen1, f.flughafen2, f.anzahl_fluge_2018, f.co2_verbrauch_mit_auslastung, f.kurzel_f1, f.kurzel_f2, f.anzahl_passagiere_2018, f.auslastung_passagiere_2018,
ST_Transform(
ST_Segmentize(
ST_Makeline(k2.the_geom, k1.the_geom
)::geography,
100000
)::geometry,
3857
) as the_geom_webmercator
FROM datenblatt_karte_koordinaten_geocodiert k1
JOIN table_0608datenblatt_karte_flugverbindungen f ON f.kurzel_f1 = k1.kurzel
JOIN datenblatt_karte_koordinaten_geocodiert k2 ON f.kurzel_f2 = k2.kurzel';
const fluglinienViz = new carto.Viz('color: blue');
const layer2 = new carto.Layer('fluglinien', fluglinienSource, fluglinienViz);

fluglinienLayer.addTo(map); */

</script>

</body>
